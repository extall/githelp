<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Git Help</title>

		<link rel="stylesheet" href="css/reset.css">
		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/black.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/monokai.css">

		<!-- Specific style changes -->
		<style>
			.reveal p.left {
				text-align: left;
			}
		</style>

		<!-- The terminal styles -->
		<link rel="stylesheet" href="node_modules/xterm/dist/xterm.css" />
		
		<script type="module">
        // Import Xterm reqs.
        import * as attach from './node_modules/xterm/dist/addons/attach/attach.js';
        import * as fit from './node_modules/xterm/dist/addons/fit/fit.js';
		</script>

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">

				<section>
					<h3 style="margin-top:2em;">Git Help: A Concise Introduction with Live Examples</h3>
					<h4 style="margin-top:1.25em;">Dr. Aleksei Tepljakov</h4>
					<p style="margin-top: -0.5em; font-size: 0.7em; color: #ccc; text-shadow: 1px 1px #000;">Head of Re:creation VR&AR Laboratory, Centre for Intelligent Systems<br />Department of Computer Systems, Tallinn University of Technology, Estonia</p>
				</section>

				<section style="font-size: 0.85em;">
					<h3>Acknowledgements</h3>
					<p class="left">This interactive presentation is largely based on the materials from the <a href="https://homes.cs.washington.edu/~rjust/courses/2020Spring/CSE403">Software Engineering course</a> read in University of Washington by Ren√© Just as well as the official <a href="https://git-scm.com/book/en/v2">Git Book</a>.</p>
					<p class="left">The development of this presentation was partially supported by a teaching grant awarded to Aleksei Tepljakov in 2019.</p>
				</section>

				<section style="font-size: 0.8em">
					<h3>Prerequisites</h3>
					<p class="left">Required:</p>
					<ol style="display: block;">
						<li>Download and install Git from <a href="https://git-scm.com/">https://git-scm.com/</a></li>
						<li>Register an account at GitHub: <a href="https://github.com/">https://github.com/</a></li>
					</ol>
					<p class="left">Optional:</p>
					<ol style="display: block">
						<li><a href="https://sourcegear.com/diffmerge/">https://sourcegear.com/diffmerge/</a> (you will need a merge tool)</li>
						<li><a href="http://gitextensions.github.io/">http://gitextensions.github.io/</a> (graphical user interface for Git)</li>
					</ol>
				</section>
				<section>Slide 2</section>
				
				<section data-state="terminal-01">
                    <h5>Let's clone a repository!</h5>
                    <div data-is-terminal data-dir="~"></div>
                </section>

				<section data-state="terminal-02">
					<h5>Another terminal! Will it work</h5>
					<div data-is-terminal data-dir="~"></div>
				</section>
				
			</div>
		</div>

		<script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.6.0/lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script defe="true">
		
			var initialisedTerminals = {};
		
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				hash: true,
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/highlight/highlight.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'node_modules/xterm/dist/xterm.js', async: true, callback: function() {
                    Terminal.applyAddon(attach);
                    Terminal.applyAddon(fit);
                    var endpoint = `${location.hostname}:${location.port}`;

                    var terminalUrl = `//${endpoint}/terminal`;
                    var terminalSections = document.querySelectorAll('section[data-state^="terminal"]');
                    terminalSections.forEach(function(section) {
                        var slideId = section.getAttribute('data-state');
                        var initTerminal = function() {

                            var terminalElement = section.querySelector('*[data-is-terminal]');

                            if (!terminalElement) {
                                return;
                            }

                            var desiredDir = terminalElement.getAttribute('data-dir') || '';
                            var updateTerminal = function(dir) {
                                console.log(location.pathname)
                                return fetch(terminalUrl, {
                                    method: 'POST',
                                    headers: {
                                        "Content-Type": "application/json; charset=utf-8"
                                    },
                                    body: JSON.stringify({dir: dir, location: location.pathname})
                                });
                            }
                            if (initialisedTerminals[slideId]) {
                                updateTerminal(desiredDir);
                                return;
                            }

                            var terminal = initialisedTerminals[slideId] = new Terminal({
                                'macOptionIsMeta': true,
                                'theme': {
                                    'background': '#212121',
                                    'foreground': '#eeeeee',
                                    'cursor': '#fbd015',
                                    'cursorAccent': '#212121',
                                    'selection': '#8a7d65',
                                },
                                // These can be adjusted for the presentation
                                'cols': 20,
                                'rows': 20,
                                'fontSize': 20
                            });

                            terminal.on('resize', function(size) {
                                var cols = size.cols,
                                    rows = size.rows,
                                    url = terminalUrl + '/size?cols=' + cols + '&rows=' + rows;
                                fetch(url, {method: 'POST'});
                            });

                            terminal.open(terminalElement);
                            terminal.fit();
                            Reveal.layout();
                            updateTerminal(desiredDir)
                            .then(function () {
                                var socket = new WebSocket(`ws://${terminalUrl}`);
                                socket.onopen = function() {
                                    terminal.attach(socket);
                                    terminal._initialized = true;
                                    terminal.fit();
                                    Reveal.layout();
                                };
                            });
                        };
                        var setListener = function() {
                            Reveal.addEventListener(slideId, function() {
                                setTimeout(initTerminal, 100); // Give some time to load the terminal
                            }, false);
                        };

                        if (Reveal.getCurrentSlide() === section) {
                            initTerminal();
                        }
                        setListener()
                    });
                } }
				]
			});
		</script>
		<script>
        // LiveReload Updates (hardcoded).
        document.write('<script src="http://' + location.hostname +
        ':35729/livereload.js?snipver=1"></' +
        'script>');
    </script>
	</body>
</html>
